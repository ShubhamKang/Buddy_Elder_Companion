"use strict";(self.webpackChunkreact_website=self.webpackChunkreact_website||[]).push([[221],{221:(e,l,a)=>{a.r(l),a.d(l,{default:()=>c});var t=a(43),s=a(615),r=a(196),i=a(667),n=a(579);const c=()=>{const e=(0,s.Zp)(),[l,a]=(0,t.useState)({fullName:"",mobileNumber:"",email:""}),[c,o]=(0,t.useState)(!0),[m,u]=(0,t.useState)(!1),[d,b]=(0,t.useState)(!1);(0,t.useEffect)(()=>{const e=r.j2.onAuthStateChanged(async e=>{if(e){try{const l=await(0,i.x7)((0,i.H9)(r.db,"users",e.uid));if(l.exists()){const t=l.data();a({fullName:t.fullName||"",mobileNumber:t.mobileNumber||(e.phoneNumber||"").replace("+91",""),email:t.email||""})}else a({fullName:e.displayName||"",mobileNumber:(e.phoneNumber||"").replace("+91",""),email:e.email||""})}catch(l){}o(!1)}else o(!1)});return()=>e()},[]);const N=(e,l)=>a(a=>({...a,[e]:l}));return c?null:(0,n.jsxs)("div",{className:"profile-page",children:[(0,n.jsxs)("div",{className:"profile-header",children:[(0,n.jsx)("button",{className:"back-btn",onClick:()=>e("/home"),children:"\u2190"}),(0,n.jsx)("h2",{children:"Profile"})]}),(0,n.jsxs)("form",{className:"profile-form",onSubmit:async a=>{if(a.preventDefault(),l.fullName.trim()){u(!0);try{const a=r.j2.currentUser;if(!a)return;const t=(0,i.H9)(r.db,"users",a.uid);await(0,i.BN)(t,{fullName:l.fullName.trim(),mobileNumber:l.mobileNumber,email:l.email.trim()},{merge:!0}),alert("Profile updated"),e(-1)}catch(t){console.error(t),alert("Failed to update profile. Please try again.")}finally{u(!1)}}},children:[(0,n.jsx)("label",{className:"label",children:"Name *"}),(0,n.jsx)("input",{className:"input",type:"text",value:l.fullName,onChange:e=>N("fullName",e.target.value),placeholder:"Your name",required:!0}),(0,n.jsx)("label",{className:"label",children:"Mobile Number *"}),(0,n.jsx)("input",{className:"input",type:"tel",value:l.mobileNumber,onChange:e=>N("mobileNumber",e.target.value),placeholder:"Mobile number",inputMode:"numeric",readOnly:!0}),(0,n.jsx)("label",{className:"label",children:"Email Address *"}),(0,n.jsx)("input",{className:"input",type:"email",value:l.email,onChange:e=>N("email",e.target.value),placeholder:"Enter your email",required:!0}),(0,n.jsx)("button",{className:"submit-btn",type:"submit",disabled:m||!l.fullName.trim(),children:m?"Saving...":"Submit"})]}),(0,n.jsx)("hr",{className:"divider"}),(0,n.jsxs)("div",{className:"delete-section",children:[(0,n.jsx)("div",{className:"delete-title",children:"Delete Account"}),(0,n.jsx)("p",{className:"delete-note",children:"Deleting your account will remove all your orders, wallet amount and any active referral."}),(0,n.jsx)("button",{className:"delete-btn",onClick:()=>b(!0),children:"Delete"})]}),d&&(0,n.jsx)("div",{className:"modal-overlay",role:"dialog","aria-modal":"true",onClick:()=>b(!1),children:(0,n.jsxs)("div",{className:"modal",onClick:e=>e.stopPropagation(),children:[(0,n.jsx)("h3",{className:"modal-title",children:"Delete account?"}),(0,n.jsx)("p",{className:"modal-text",children:"This action cannot be undone."}),(0,n.jsxs)("div",{className:"modal-actions",children:[(0,n.jsx)("button",{className:"btn-secondary",onClick:()=>b(!1),children:"Cancel"}),(0,n.jsx)("button",{className:"btn-danger",onClick:async()=>{try{const a=r.j2.currentUser;if(!a)return;await(0,i.kd)((0,i.H9)(r.db,"users",a.uid));try{await a.delete()}catch(l){console.warn("Auth deletion needs recent login. Only data removed.",l)}await r.j2.signOut(),e("/")}catch(l){console.error(l),alert("Could not delete account. Please try again later.")}},children:"Delete"})]})]})})]})}}}]);
//# sourceMappingURL=221.0ed98750.chunk.js.map