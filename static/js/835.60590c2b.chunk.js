"use strict";(self.webpackChunkreact_website=self.webpackChunkreact_website||[]).push([[835],{215:(e,o,t)=>{t.d(o,{A:()=>s});const n={getCurrentPosition:async e=>new Promise((o,t)=>{navigator.geolocation?navigator.geolocation.getCurrentPosition(o,e=>t(e),e):t({code:"UNSUPPORTED",message:"Geolocation not supported"})}),async watchPosition(e,o){if(!navigator.geolocation)return null;return navigator.geolocation.watchPosition(e=>o(e,null),e=>o(null,e),e)},async clearWatch(e){let{id:o}=e;null!=o&&navigator.geolocation&&navigator.geolocation.clearWatch(o)}},i=!1,a=()=>"web",r=async()=>{};const s=new class{constructor(){this.isNative=i,this.platform=a(),this.permissionStatus=null,this.locationWatchId=null}async ensureHighAccuracy(){var e,o,t;if(!this.isNative||"android"!==this.platform)return;const n=null===(e=window)||void 0===e||null===(o=e.cordova)||void 0===o||null===(t=o.plugins)||void 0===t?void 0:t.locationAccuracy;return n?new Promise(e=>{try{n.canRequest(o=>{if(!o)return e(!1);n.request(n.REQUEST_PRIORITY_HIGH_ACCURACY,()=>{console.log("[LocationService] High-accuracy location enabled"),e(!0)},o=>{console.warn("[LocationService] High-accuracy request failed",o),e(!1)})})}catch(o){console.warn("[LocationService] ensureHighAccuracy exception",o),e(!1)}}):void 0}async checkPermissionStatus(){try{if(navigator.permissions){return(await navigator.permissions.query({name:"geolocation"})).state}return"prompt"}catch(e){return console.error("Permission check error:",e),"prompt"}}async requestPermission(){try{const o=await this.checkPermissionStatus();if("granted"===o)return{status:"granted",needsSettings:!1};if("denied"===o)return{status:"denied",needsSettings:!0};try{return await this.getCurrentLocation(),{status:"granted",needsSettings:!1}}catch(e){if(1===e.code||"PERMISSION_DENIED"===e.code)return{status:"denied",needsSettings:!0};throw e}}catch(e){return console.error("Permission request error:",e),{status:"error",error:e.message,needsSettings:!1}}}async getCurrentLocation(){const e={enableHighAccuracy:!0,timeout:1e4,maximumAge:0,...arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}};try{const o=await n.getCurrentPosition(e);return{latitude:o.coords.latitude,longitude:o.coords.longitude,accuracy:o.coords.accuracy,timestamp:o.timestamp}}catch(o){throw this.handleLocationError(o)}}async watchLocation(e){const o={enableHighAccuracy:!0,timeout:1e4,maximumAge:0,...arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}};try{return this.locationWatchId=await n.watchPosition(o,(o,t)=>{t?e(null,this.handleLocationError(t)):e({latitude:o.coords.latitude,longitude:o.coords.longitude,accuracy:o.coords.accuracy,timestamp:o.timestamp},null)}),this.locationWatchId}catch(t){throw this.handleLocationError(t)}}async clearWatch(){this.locationWatchId&&(await n.clearWatch({id:this.locationWatchId}),this.locationWatchId=null)}async openAppSettings(){if(this.isNative&&"android"===this.platform)try{return await r(),!0}catch(e){return console.error("Failed to open settings:",e),!1}return!1}handleLocationError(e){const o={1:{code:"PERMISSION_DENIED",message:"Location permission denied"},2:{code:"POSITION_UNAVAILABLE",message:"Location unavailable"},3:{code:"TIMEOUT",message:"Location request timed out"}};return e.code&&o[e.code]?{...o[e.code],originalError:e}:{code:"UNKNOWN_ERROR",message:e.message||"Unknown location error",originalError:e}}async getAddressFromCoords(e,o){try{var t,n;if(null!==(t=window.google)&&void 0!==t&&null!==(n=t.maps)&&void 0!==n&&n.Geocoder){const t=new window.google.maps.Geocoder,n=await new Promise(n=>{t.geocode({location:{lat:e,lng:o}},(e,o)=>{if("OK"===o&&e&&e.length>0){var t,i,a,r,s;const o=e[0];n({formatted:o.formatted_address,components:{area:(null===(t=o.address_components.find(e=>e.types.includes("sublocality")))||void 0===t?void 0:t.long_name)||"",city:(null===(i=o.address_components.find(e=>e.types.includes("locality")))||void 0===i?void 0:i.long_name)||"",state:(null===(a=o.address_components.find(e=>e.types.includes("administrative_area_level_1")))||void 0===a?void 0:a.long_name)||"",country:(null===(r=o.address_components.find(e=>e.types.includes("country")))||void 0===r?void 0:r.long_name)||"",pincode:(null===(s=o.address_components.find(e=>e.types.includes("postal_code")))||void 0===s?void 0:s.long_name)||""}})}else n(null)})});if(n)return n}}catch(a){}try{const t="AIzaSyC62wo52XfJDOBnJc6VAQDDbse3a-KKy-k",n=await fetch(`https://maps.googleapis.com/maps/api/geocode/json?latlng=${e},${o}&key=${t}`);if(n.ok){var i;const e=null===(i=(await n.json()).results)||void 0===i?void 0:i[0];if(e)return{formatted:e.formatted_address,components:{}}}}catch(r){}return null}async isLocationEnabled(){if(this.isNative)try{return await this.getCurrentLocation({timeout:2e3}),!0}catch(e){return"POSITION_UNAVAILABLE"!==e.code}return!0}}},835:(e,o,t)=>{t.d(o,{A:()=>u});var n=t(43),i=t(215),a=t(579);const r=async()=>{if(window.google&&window.google.maps)return;const e=document.createElement("script");e.src="https://maps.googleapis.com/maps/api/js?key=AIzaSyC62wo52XfJDOBnJc6VAQDDbse3a-KKy-k&libraries=places",e.async=!0,await new Promise((o,t)=>{e.onload=o,e.onerror=t,document.head.appendChild(e)})},s={zoom:14,gestureHandling:"greedy"},l=()=>!1,c=e=>new Promise((o,t)=>navigator.geolocation.getCurrentPosition(o,t,e)),d=async()=>({location:"granted"}),g=async()=>{},p=async()=>({platform:"web"}),u=e=>{let{onLocationSelect:o,onClose:t}=e;const u=(0,n.useRef)(null),m=(0,n.useRef)(null),h=(0,n.useRef)(null),x=(0,n.useRef)(null),[f,y]=(0,n.useState)(null),[w,v]=(0,n.useState)({lat:26.8467,lng:80.9462}),[b,S]=(0,n.useState)(!0),[j,A]=(0,n.useState)(!1),[P,k]=(0,n.useState)(""),[I,L]=(0,n.useState)(!1),[C,z]=(0,n.useState)(!1),[_,R]=(0,n.useState)(!1),[T,E]=(0,n.useState)(!1),[M,D]=(0,n.useState)(0),[W,G]=(0,n.useState)(!1),[N,O]=(0,n.useState)(!1),[U,B]=(0,n.useState)({show:!1,message:"",type:"success"}),[F,H]=(0,n.useState)([]),[$,q]=(0,n.useState)(!1),[K,Y]=(0,n.useState)(!1),[V,J]=(0,n.useState)(-1),[X,Q]=(0,n.useState)(null);(0,n.useEffect)(()=>()=>{console.log("Unmounting Map component and cleaning up resources..."),m.current&&(console.log("Cleaning up Google Map instance."),m.current=null),h.current&&(console.log("Cleaning up map marker."),h.current.setMap(null),h.current=null),x.current&&clearTimeout(x.current)},[]);const Z=function(e){let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"success";console.log("\ud83d\udd14 Toast:",e,o),B({show:!0,message:e,type:o}),setTimeout(()=>{B({show:!1,message:"",type:"success"})},3e3)},ee=async()=>{try{A(!0),console.log("\ud83d\udcf1 Requesting location with high accuracy to trigger Google dialog...");const e=await c({enableHighAccuracy:!0,timeout:2e4,maximumAge:3e4});console.log("\u2705 Location obtained with high accuracy:",e),await oe(e)}catch(e){console.error("\u274c Location error:",e);const t=e.message||"";if(t.includes("permission")||t.includes("denied")||t.includes("User denied")||1===e.code){console.log("\ud83d\udeab Permission denied - checking if permanent...");try{"denied"===(await d()).location?(console.log('\ud83d\udeab "Don\'t ask again" detected - showing Hindi settings dialog'),O(!0),z(!0),Z("Location permanently blocked. \u0915\u0943\u092a\u092f\u093e settings \u092e\u0947\u0902 \u091c\u093e\u0915\u0930 enable \u0915\u0930\u0947\u0902\u0964","info")):(console.log("\u26a0\ufe0f Normal permission denial - can retry"),z(!0),Z("Location access denied. \u0915\u0943\u092a\u092f\u093e permission allow \u0915\u0930\u0947\u0902\u0964","info"))}catch(o){console.log("\ud83d\udeab Permission check failed - assuming permanent denial"),O(!0),z(!0),Z("Location access denied. \u0915\u0943\u092a\u092f\u093e settings \u092e\u0947\u0902 enable \u0915\u0930\u0947\u0902\u0964","info")}}else console.log("\ud83d\udccd Location accuracy issue - showing custom high accuracy dialog"),R(!0),Z("Location accuracy required. \u0915\u0943\u092a\u092f\u093e high accuracy enable \u0915\u0930\u0947\u0902\u0964","info")}A(!1)},oe=async e=>{var o,t;const n={lat:e.coords.latitude,lng:e.coords.longitude};v(n),console.log("\ud83d\udd0d Resolving address for coordinates:",n);let a=null,r="Current Location";if(null!==(o=window.google)&&void 0!==o&&null!==(t=o.maps)&&void 0!==t&&t.Geocoder)try{console.log("\ud83c\udf10 Using Google Geocoding API...");const e=new window.google.maps.Geocoder,o=await new Promise(o=>{e.geocode({location:n},(e,t)=>{if("OK"===t&&e&&e.length>0){var n,i,a;const t=e[0];console.log("\u2705 Google geocoding success:",t.formatted_address),o({formatted:t.formatted_address,name:(null===(n=t.address_components[0])||void 0===n?void 0:n.long_name)||"Current Location",components:{area:(null===(i=t.address_components.find(e=>e.types.includes("sublocality")))||void 0===i?void 0:i.long_name)||"",city:(null===(a=t.address_components.find(e=>e.types.includes("locality")))||void 0===a?void 0:a.long_name)||""}})}else console.log("\u26a0\ufe0f Google geocoding failed:",t),o(null)})});o&&(a=o.formatted,r=o.name)}catch(c){console.error("\u274c Google geocoding error:",c)}if(!a)try{console.log("\ud83d\udd04 Fallback to location service...");const o=await i.A.getAddressFromCoords(e.coords.latitude,e.coords.longitude);null!==o&&void 0!==o&&o.formatted&&(a=o.formatted,console.log("\u2705 Location service success:",a))}catch(c){console.error("\u274c Location service error:",c)}a||(a=`\ud83d\udccd ${e.coords.latitude.toFixed(4)}, ${e.coords.longitude.toFixed(4)}`,console.log("\ud83d\udccd Using coordinates as fallback:",a));const s={...n,address:a,name:r,accuracy:e.coords.accuracy};console.log("\ud83c\udfaf Final location data:",s),y(s),m.current&&h.current&&(h.current.setPosition(n),m.current.panTo(n),m.current.setZoom(17));const l=e.coords.accuracy?` (\xb1${Math.round(e.coords.accuracy)}m)`:"";Z(`\ud83d\udccd Location detected${l}${W?" [High Accuracy]":""}!`,"success")};(0,n.useEffect)(()=>{let e=!0;const o=l();E(o),console.log("\ud83d\udd0d Platform detected:",o?"Capacitor App":"Browser"),sessionStorage.setItem("mapComponentActive","true");const t=()=>{if(e&&u.current)try{console.log("\ud83d\udd27 Setting up Google Maps...");const o=new window.google.maps.Map(u.current,{...s,center:w,disableDefaultUI:!0,zoomControl:!0,zoomControlOptions:{position:window.google.maps.ControlPosition.RIGHT_BOTTOM}});m.current=o;const t=new window.google.maps.Marker({position:w,map:o,draggable:!0,title:"Drag to select location",icon:void 0,animation:window.google.maps.Animation.DROP});h.current=t,t.addListener("dragend",()=>{if(!e)return;const o=t.getPosition(),n={lat:o.lat(),lng:o.lng()};v(n),te(n)}),o.addListener("click",o=>{if(!e)return;const n={lat:o.latLng.lat(),lng:o.latLng.lng()};t.setPosition(n),v(n),te(n)}),e&&(L(!0),S(!1),console.log("\ud83c\udf89 Google Maps ready!"))}catch(o){console.error("\u274c Map setup error:",o),e&&(L(!1),S(!1))}};return(async()=>{if(e)try{if(console.log("\ud83d\uddfa\ufe0f Initializing map..."),window.google&&window.google.maps)console.log("\u2705 Google Maps already loaded"),t();else{if(console.log("\ud83d\udd04 Loading Google Maps API..."),await r(),!(e&&window.google&&window.google.maps))throw new Error("Google Maps failed to load");console.log("\u2705 Google Maps loaded successfully"),t()}}catch(o){console.warn("\u26a0\ufe0f Map initialization failed:",o),e&&(L(!1),S(!1))}})(),()=>{if(e=!1,sessionStorage.removeItem("mapComponentActive"),m.current)try{window.google.maps.event.clearInstanceListeners(m.current)}catch(o){console.log("Map cleanup error:",o)}if(h.current)try{window.google.maps.event.clearInstanceListeners(h.current),h.current.setMap(null)}catch(o){console.log("Marker cleanup error:",o)}console.log("\ud83e\uddf9 Cleanup completed")}},[]);const te=async e=>{console.log("\ud83d\udd0d Updating address for map interaction:",e);let o=null,t="Selected Location";try{var n,a;if(null!==(n=window.google)&&void 0!==n&&null!==(a=n.maps)&&void 0!==a&&a.Geocoder){const n=new window.google.maps.Geocoder,i=await new Promise(o=>{n.geocode({location:e},(e,t)=>{if("OK"===t&&e&&e.length>0){var n;const t=e[0];console.log("\u2705 Map interaction - Google geocoding success:",t.formatted_address),o({address:t.formatted_address,name:(null===(n=t.address_components[0])||void 0===n?void 0:n.long_name)||"Selected Location"})}else console.log("\u26a0\ufe0f Map interaction - Google geocoding failed:",t),o(null)})});i&&(o=i.address,t=i.name)}if(!o)try{console.log("\ud83d\udd04 Map interaction - Using location service fallback...");const t=await i.A.getAddressFromCoords(e.lat,e.lng);null!==t&&void 0!==t&&t.formatted&&(o=t.formatted,console.log("\u2705 Map interaction - Location service success:",o))}catch(r){console.error("\u274c Map interaction - Location service error:",r)}o||(o=`\ud83d\udccd ${e.lat.toFixed(4)}, ${e.lng.toFixed(4)}`,console.log("\ud83d\udccd Map interaction - Using coordinates fallback:",o));const s={address:o,lat:e.lat,lng:e.lng,name:t};console.log("\ud83c\udfaf Map interaction - Final location:",s),y(s)}catch(s){console.error("\u274c Map interaction - Address update error:",s),y({address:`\ud83d\udccd ${e.lat.toFixed(4)}, ${e.lng.toFixed(4)}`,lat:e.lat,lng:e.lng,name:"Selected Location"})}},ne=async e=>{if(e.trim()&&I){try{if(window.google.maps.places&&window.google.maps.places.AutocompleteService){const o=new window.google.maps.places.AutocompleteService,t=new window.google.maps.places.PlacesService(document.createElement("div")),n={input:e,componentRestrictions:{country:"IN"},types:["establishment","geocode"]};o.getPlacePredictions(n,(e,o)=>{if(o===window.google.maps.places.PlacesServiceStatus.OK&&e&&e.length>0){const o={placeId:e[0].place_id,fields:["name","geometry","formatted_address","place_id"]};t.getDetails(o,(e,o)=>{if(o===window.google.maps.places.PlacesServiceStatus.OK&&e){const o={lat:e.geometry.location.lat(),lng:e.geometry.location.lng()};y({address:e.formatted_address,lat:o.lat,lng:o.lng,name:e.name||"Selected Location"}),v(o),m.current&&h.current&&(m.current.panTo(o),m.current.setZoom(16),h.current.setPosition(o)),Z(`Location found: ${e.formatted_address}`,"success")}})}else Z("No locations found. Try a different search term.","error")})}}catch(o){console.error("Search error:",o),Z("Search failed. Please try again.","error")}k("")}},ie=async()=>{try{if(T&&l()){z(!1),R(!1),console.log("\ud83d\udd27 Opening native settings with enhanced methods...");let t=!1;const n=await p();console.log("\ud83d\udcf1 Device Info:",n);try{console.log("\ud83d\udd38 Trying openappsettings plugin..."),window.cordova&&window.cordova.plugins.settings?window.cordova.plugins.settings.open("application_details",()=>{console.log("\u2705 Settings opened via cordova-open-native-settings plugin"),t=!0},()=>{console.error("\u274c Failed to open settings via cordova plugin")}):console.log("cordova-open-native-settings plugin not available.")}catch(e){console.log("\u26a0\ufe0f openappsettings failed, trying fallback methods:",e.message);try{console.log("\ud83d\udd38 Trying native App.openSettings()..."),await g(),t=!0,console.log("\u2705 Native settings opened successfully"),Z("\ud83d\udd27 Go to Permissions \u2192 Location \u2192 Allow","info")}catch(o){console.log("\u26a0\ufe0f Native App.openSettings() failed:",o.message)}}t?(console.log("\ud83d\udd04 Settings opened, starting auto-detection..."),re(),setTimeout(()=>{Z("\ud83d\udca1 We'll automatically detect when you enable location and return to the app!","info")},2e3)):(console.log("\u26a0\ufe0f All native methods failed, showing device-specific manual instructions"),ae(n))}}catch(t){console.error("\u274c Enhanced settings opening error:",t),ae()}},ae=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;try{e||(e=await p());let i="",a="\ud83d\udcf1";var o,t,n;if("android"===e.platform)a="\ud83e\udd16",i=null!==(o=e.manufacturer)&&void 0!==o&&o.toLowerCase().includes("samsung")?"Samsung: Settings \u2192 Apps \u2192 DhipyCare \u2192 Permissions \u2192 Location \u2192 Allow":null!==(t=e.manufacturer)&&void 0!==t&&t.toLowerCase().includes("xiaomi")?"Xiaomi: Settings \u2192 Apps \u2192 Manage apps \u2192 DhipyCare \u2192 Permissions \u2192 Location":null!==(n=e.manufacturer)&&void 0!==n&&n.toLowerCase().includes("huawei")?"Huawei: Settings \u2192 Apps \u2192 DhipyCare \u2192 Permissions \u2192 Location \u2192 Allow":"Android: Settings \u2192 Apps \u2192 DhipyCare \u2192 Permissions \u2192 Location \u2192 Allow";else"ios"===e.platform?(a="\ud83c\udf4e",i="iOS: Settings \u2192 Privacy & Security \u2192 Location Services \u2192 DhipyCare \u2192 While Using App"):i="Please enable location permission for DhipyCare in your device settings";console.log("\ud83d\udcd6 Enhanced instructions for",e.manufacturer,e.model,":",i),Z(`${a} ${i}`,"info"),setTimeout(()=>{z(!0)},2e3),re()}catch(i){console.error("Error showing enhanced instructions:",i),Z("Please enable location permission for DhipyCare in device settings","info"),re()}},re=()=>{console.log("\ud83d\udd04 Starting permission monitoring...");const e=setInterval(async()=>{try{if(!T)return console.log("\ud83d\uded1 Not a Capacitor app, stopping monitoring"),void clearInterval(e);const o=await d();console.log("\ud83d\udd0d Monitoring check - permission:",o.location),"granted"===o.location&&(console.log("\u2705 Location permission auto-detected as granted!"),O(!1),D(0),clearInterval(e),z(!1),R(!1),Z("\ud83c\udf89 Location enabled! Getting your location...","success"),setTimeout(()=>{ee()},1e3))}catch(o){console.error("\u274c Error in permission monitoring:",o),clearInterval(e)}},3e3);setTimeout(()=>{clearInterval(e),console.log("\ud83d\uded1 Stopped permission monitoring after 3 minutes")},18e4)},se=()=>{z(!1),T&&N?ie():(console.log("\ud83d\udd04 Retrying location request - direct call to requestCapacitorLocation"),O(!1),ee())},le=()=>{z(!1),T?ie():Z("Please allow location access in browser settings and refresh the page.","info")},ce=()=>{z(!1),Z("Please search for your location manually using the search bar.","info")},de=()=>{R(!1),console.log("\ud83c\udfaf User enabled high accuracy - retrying Google accuracy dialog"),ee()},ge=()=>{R(!1),console.log("\u23ed\ufe0f User skipped high accuracy - will retry next time"),Z("Location accuracy skipped. \u0906\u092a \u092c\u093e\u0926 \u092e\u0947\u0902 \u092d\u0940 enable \u0915\u0930 \u0938\u0915\u0924\u0947 \u0939\u0948\u0902\u0964","info")},pe=()=>C?(0,a.jsx)("div",{style:{position:"fixed",top:0,left:0,width:"100%",height:"100%",background:"rgba(0, 0, 0, 0.6)",zIndex:1e4,display:"flex",alignItems:"center",justifyContent:"center",padding:"20px",boxSizing:"border-box"},children:(0,a.jsxs)("div",{style:{background:"white",borderRadius:"16px",padding:"24px",maxWidth:"380px",width:"100%",textAlign:"center",boxShadow:"0 10px 40px rgba(0,0,0,0.15)"},children:[(0,a.jsx)("div",{style:{fontSize:"48px",marginBottom:"16px"},children:"\ud83d\udccd"}),(0,a.jsx)("h3",{style:{fontSize:"20px",fontWeight:"600",marginBottom:"12px",color:"#1f2937"},children:T&&N?"Enable Location Services":"Location Access Required"}),(0,a.jsx)("p",{style:{fontSize:"16px",color:"#6b7280",lineHeight:"1.5",marginBottom:"24px"},children:T&&N?(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{style:{marginBottom:"12px"},children:"\u0915\u0948\u0938\u0947 location allow \u0915\u0930\u0947\u0902:"}),(0,a.jsxs)("div",{style:{background:"#f9fafb",padding:"12px",borderRadius:"8px",fontSize:"14px",textAlign:"left",border:"1px solid #e5e7eb"},children:[(0,a.jsx)("strong",{children:"\ud83d\udcf1 Android:"}),(0,a.jsx)("br",{}),"Settings \u2192 Apps \u2192 DhipyCare \u2192 Permissions \u2192 Location \u2192 Allow",(0,a.jsx)("br",{}),(0,a.jsx)("br",{}),(0,a.jsx)("strong",{children:"\ud83c\udf4e iOS:"}),(0,a.jsx)("br",{}),"Settings \u2192 Privacy \u2192 Location Services \u2192 DhipyCare \u2192 While Using App"]})]}):T?"\u0939\u092e\u0947\u0902 \u0906\u092a\u0915\u0947 \u092a\u093e\u0938 \u0915\u0947 healthcare services \u0916\u094b\u091c\u0928\u0947 \u0914\u0930 accurate delivery \u0915\u0947 \u0932\u093f\u090f location access \u091a\u093e\u0939\u093f\u090f\u0964":"Please allow location access in your browser to automatically detect your current location for better service."}),(0,a.jsxs)("div",{style:{marginBottom:"16px"},children:[(0,a.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"12px",padding:"12px",background:"#f3f4f6",borderRadius:"8px",marginBottom:"8px"},children:[(0,a.jsx)("span",{style:{fontSize:"20px"},children:"\ud83c\udfe5"}),(0,a.jsx)("span",{style:{fontSize:"14px",color:"#374151"},children:"Find nearby doctors & services"})]}),(0,a.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"12px",padding:"12px",background:"#f3f4f6",borderRadius:"8px"},children:[(0,a.jsx)("span",{style:{fontSize:"20px"},children:"\ud83d\ude9a"}),(0,a.jsx)("span",{style:{fontSize:"14px",color:"#374151"},children:"Accurate delivery tracking"})]})]}),T&&N?(0,a.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"16px"},children:[(0,a.jsxs)("div",{style:{display:"flex",gap:"12px",justifyContent:"flex-end"},children:[(0,a.jsx)("button",{onClick:ce,style:{background:"transparent",color:"#6b7280",border:"none",padding:"12px 20px",fontSize:"16px",fontWeight:"500",cursor:"pointer",textTransform:"uppercase"},children:"CANCEL"}),(0,a.jsx)("button",{onClick:ie,style:{background:"transparent",color:"#2c5aa0",border:"none",padding:"12px 20px",fontSize:"16px",fontWeight:"500",cursor:"pointer",textTransform:"uppercase"},children:"SETTINGS"})]}),(0,a.jsx)("div",{style:{textAlign:"center",margin:"8px 0"},children:(0,a.jsx)("span",{style:{fontSize:"14px",color:"#9ca3af",fontWeight:"500"},children:"OR"})}),(0,a.jsx)("button",{onClick:se,style:{background:"linear-gradient(135deg, #2c5aa0 0%, #1e3d6f 100%)",color:"white",border:"none",borderRadius:"8px",padding:"16px",fontSize:"16px",fontWeight:"600",cursor:"pointer",width:"100%"},children:"Grant Permission"})]}):(0,a.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"12px"},children:[(0,a.jsx)("button",{onClick:se,style:{background:"linear-gradient(135deg, #2c5aa0 0%, #1e3d6f 100%)",color:"white",border:"none",borderRadius:"12px",padding:"16px",fontSize:"16px",fontWeight:"600",cursor:"pointer",transition:"all 0.2s ease"},children:"Allow Location Access"}),(0,a.jsxs)("div",{style:{display:"flex",gap:"8px"},children:[(0,a.jsx)("button",{onClick:le,style:{background:"#f3f4f6",color:"#374151",border:"none",borderRadius:"8px",padding:"12px",fontSize:"14px",fontWeight:"500",cursor:"pointer",flex:1},children:"Settings"}),(0,a.jsx)("button",{onClick:ce,style:{background:"#f3f4f6",color:"#374151",border:"none",borderRadius:"8px",padding:"12px",fontSize:"14px",fontWeight:"500",cursor:"pointer",flex:1},children:"Search Manually"})]})]}),(0,a.jsx)("div",{style:{fontSize:"12px",color:"#9ca3af",marginTop:"16px",lineHeight:"1.4"},children:T&&N?"Permission Denied \u2022 Open Settings Required":`Attempt ${M} \u2022 ${T?"Native App":"Browser"}`})]})}):null,ue=()=>_?(0,a.jsx)("div",{style:{position:"fixed",top:0,left:0,width:"100%",height:"100%",background:"rgba(0, 0, 0, 0.6)",zIndex:1e4,display:"flex",alignItems:"center",justifyContent:"center",padding:"20px",boxSizing:"border-box"},children:(0,a.jsxs)("div",{style:{background:"white",borderRadius:"16px",padding:"24px",maxWidth:"380px",width:"100%",textAlign:"center",boxShadow:"0 10px 40px rgba(0,0,0,0.15)"},children:[(0,a.jsx)("div",{style:{fontSize:"48px",marginBottom:"16px"},children:"\ud83c\udfaf"}),(0,a.jsx)("h3",{style:{fontSize:"20px",fontWeight:"600",marginBottom:"12px",color:"#1f2937"},children:"High Accuracy Required"}),(0,a.jsxs)("p",{style:{fontSize:"16px",color:"#6b7280",lineHeight:"1.5",marginBottom:"24px"},children:[(0,a.jsx)("div",{style:{marginBottom:"12px"},children:'\u092c\u0947\u0939\u0924\u0930 location accuracy \u0915\u0947 \u0932\u093f\u090f Google \u0915\u093e "Turn on location accuracy" dialog \u092b\u093f\u0930 \u0938\u0947 \u0926\u093f\u0916\u093e\u090f\u0902?'}),(0,a.jsx)("div",{style:{fontSize:"14px",color:"#9ca3af"},children:"This will show Google's location accuracy dialog again for precise location detection."})]}),(0,a.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"12px"},children:[(0,a.jsx)("button",{onClick:de,style:{background:"linear-gradient(135deg, #059669 0%, #047857 100%)",color:"white",border:"none",borderRadius:"12px",padding:"16px",fontSize:"16px",fontWeight:"600",cursor:"pointer"},children:"\ud83c\udfaf Show Google Accuracy Dialog"}),(0,a.jsx)("button",{onClick:ge,style:{background:"#f3f4f6",color:"#374151",border:"none",borderRadius:"8px",padding:"12px",fontSize:"14px",fontWeight:"500",cursor:"pointer"},children:"Skip / \u092c\u093e\u0926 \u092e\u0947\u0902 \u0915\u0930\u0947\u0902"})]})]})}):null;(0,n.useEffect)(()=>{if(!T)return;return()=>{}},[T,N]);const me=async e=>{if(!e.trim()||e.length<2)return H([]),q(!1),void Y(!1);try{Y(!0),console.log("\ud83d\udd0d Performing autocomplete search for:",e);const t=()=>window.google&&window.google.maps&&window.google.maps.places&&window.google.maps.places.AutocompleteService;if(!t()){if(console.log("\u23f3 Google Places API not ready, waiting..."),!window.google||!window.google.maps)try{await r(),console.log("\u2705 Google Maps API loaded for autocomplete")}catch(o){return console.error("\u274c Failed to load Google Maps API:",o),Y(!1),void Z("Search temporarily unavailable. Please try current location.","info")}if(!t())return console.error("\u274c Google Places API still not available"),Y(!1),H([]),q(!1),void Z("Search service unavailable. Please use current location or try again later.","info")}console.log("\u2705 Google Places API ready, performing search...");const n=new window.google.maps.places.AutocompleteService,i={input:e,componentRestrictions:{country:"IN"}};n.getPlacePredictions(i,(o,t)=>{if(Y(!1),console.log("\ud83d\udd0d Autocomplete response:",t,(null===o||void 0===o?void 0:o.length)||0,"results"),t===window.google.maps.places.PlacesServiceStatus.OK&&o&&o.length>0){const e=o.slice(0,6).map((e,o)=>{var t,n;return{id:e.place_id,primaryText:(null===(t=e.structured_formatting)||void 0===t?void 0:t.main_text)||e.description,secondaryText:(null===(n=e.structured_formatting)||void 0===n?void 0:n.secondary_text)||"",fullText:e.description,placeId:e.place_id,index:o}});console.log("\u2705 Autocomplete results formatted:",e.length),console.log("\ud83d\udccb Setting autocomplete results:",e),H(e),q(!0),console.log("\ud83d\udc41\ufe0f Setting showAutocomplete to TRUE"),J(-1)}else console.log("\u26a0\ufe0f No autocomplete results or API error:",t),H([]),q(e.length>=2)})}catch(o){console.error("\u274c Autocomplete search error:",o),Y(!1),H([]),q(!1),Z("Search error. Please try again.","error")}},he=async e=>{if(console.log("\ud83c\udfaf Suggestion selected:",e),null!==e&&void 0!==e&&e.placeId)try{var o,t,n;if(Y(!0),q(!1),k(e.primaryText),console.log("\ud83d\udd0d Getting place details for placeId:",e.placeId),null!==(o=window.google)&&void 0!==o&&null!==(t=o.maps)&&void 0!==t&&null!==(n=t.places)&&void 0!==n&&n.PlacesService){const o=new window.google.maps.places.PlacesService(document.createElement("div")),t={placeId:e.placeId,fields:["name","geometry","formatted_address","place_id","types"]};o.getDetails(t,(o,t)=>{if(console.log("\ud83d\udccd Place details response:",t,o),Y(!1),t===window.google.maps.places.PlacesServiceStatus.OK&&o){const t={lat:o.geometry.location.lat(),lng:o.geometry.location.lng()};console.log("\u2705 New position:",t);const n={address:o.formatted_address,lat:t.lat,lng:t.lng,name:o.name||e.primaryText,placeId:o.place_id};console.log("\ud83c\udfaf Setting new location:",n),y(n),v(t),m.current&&h.current?(console.log("\ud83d\uddfa\ufe0f Updating map position"),m.current.panTo(t),m.current.setZoom(16),h.current.setPosition(t)):console.warn("\u26a0\ufe0f Map not available for update"),Z(`\ud83d\udccd Location selected: ${o.formatted_address}`,"success"),setTimeout(()=>{k("")},1500)}else console.error("\u274c Place details failed:",t),Z("Unable to get location details. Please try again.","error")})}else console.error("\u274c Places service not available"),Y(!1),Z("Places service not available. Please try again.","error")}catch(i){console.error("\u274c Suggestion selection error:",i),Z("Error selecting location. Please try again.","error"),Y(!1)}else console.error("\u274c No placeId found in suggestion")},xe=()=>(console.log("\ud83c\udfa8 AutocompleteDropdown render - showAutocomplete:",$,"results:",F.length),$?(0,a.jsxs)("div",{role:"listbox",style:{position:"absolute",top:"100%",left:"0",right:"0",background:"white",borderRadius:"0 0 8px 8px",boxShadow:"0 4px 20px rgba(0,0,0,0.15)",zIndex:2e3,maxHeight:"300px",overflowY:"auto",border:"1px solid #e5e7eb",borderTop:"none"},children:[K&&(0,a.jsxs)("div",{style:{padding:"16px",display:"flex",alignItems:"center",gap:"12px",color:"#6b7280",fontSize:"14px"},children:[(0,a.jsx)("div",{style:{width:"16px",height:"16px",border:"2px solid #e5e7eb",borderTop:"2px solid #2c5aa0",borderRadius:"50%",animation:"spin 1s linear infinite"}}),"Searching..."]}),!K&&0===F.length&&P.length>=2&&(0,a.jsxs)("div",{style:{padding:"16px",color:"#6b7280",fontSize:"14px",textAlign:"center"},children:['No locations found for "',P,'"']}),!K&&F.map((e,o)=>(0,a.jsx)("div",{role:"option",onClick:()=>he(e),onMouseDown:o=>{o.preventDefault(),he(e)},style:{padding:"12px 16px",cursor:"pointer",borderBottom:o<F.length-1?"1px solid #f3f4f6":"none",background:V===o?"#f8fafc":"transparent",transition:"background-color 0.2s ease",":hover":{backgroundColor:"#f8fafc"}},onMouseEnter:()=>J(o),onMouseLeave:()=>J(-1),children:(0,a.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[(0,a.jsx)("span",{style:{fontSize:"18px",color:"#6b7280",minWidth:"20px"},children:"\ud83d\udccd"}),(0,a.jsxs)("div",{style:{flex:1,minWidth:0},children:[(0,a.jsx)("div",{style:{fontSize:"15px",fontWeight:"600",color:"#1f2937",marginBottom:"2px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:e.primaryText}),e.secondaryText&&(0,a.jsx)("div",{style:{fontSize:"13px",color:"#6b7280",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:e.secondaryText})]}),V===o&&(0,a.jsx)("span",{style:{fontSize:"16px",color:"#2c5aa0"},children:"\u2192"})]})},e.placeId)),!K&&F.length>0&&(0,a.jsx)("div",{style:{padding:"8px 16px",fontSize:"12px",color:"#9ca3af",textAlign:"center",borderTop:"1px solid #f3f4f6",background:"#f9fafb"},children:"\u2191\u2193 Navigate \u2022 Enter to select \u2022 Esc to close"})]}):null);return(0,n.useEffect)(()=>()=>{x.current&&clearTimeout(x.current)},[]),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(pe,{}),(0,a.jsx)(ue,{}),U.show&&(0,a.jsxs)("div",{style:{position:"fixed",top:"100px",left:"50%",transform:"translateX(-50%)",zIndex:999999,maxWidth:"350px",width:"90%",padding:"15px 20px",borderRadius:"12px",boxShadow:"0 8px 25px rgba(0,0,0,0.15)",display:"flex",alignItems:"center",gap:"10px",fontSize:"14px",fontWeight:"500",animation:"fadeInUp 0.3s ease-out",background:"success"===U.type?"linear-gradient(135deg, #22c55e 0%, #16a34a 100%)":"error"===U.type?"linear-gradient(135deg, #ef4444 0%, #dc2626 100%)":"linear-gradient(135deg, #3b82f6 0%, #2563eb 100%)",color:"white"},children:[(0,a.jsx)("span",{style:{fontSize:"16px"},children:"success"===U.type?"\u2705":"error"===U.type?"\u274c":"\u2139\ufe0f"}),(0,a.jsx)("span",{children:U.message})]}),(0,a.jsx)("style",{children:"\n        @keyframes spin {\n          0% { transform: rotate(0deg); }\n          100% { transform: rotate(360deg); }\n        }\n        @keyframes fadeInUp {\n          from {\n            opacity: 0;\n            transform: translateY(20px);\n          }\n          to {\n            opacity: 1;\n            transform: translateY(0);\n          }\n        }\n      "}),(0,a.jsxs)("div",{style:{position:"fixed",top:0,left:0,width:"100%",height:"100%",background:"white",zIndex:3e3,display:"block"},children:[(0,a.jsxs)("div",{style:{background:"#2c5aa0",color:"white",padding:"15px 20px",display:"flex",alignItems:"center"},children:[(0,a.jsx)("button",{style:{background:"none",border:"none",color:"white",fontSize:"20px",marginRight:"15px",cursor:"pointer"},onClick:t,children:"\u2190"}),(0,a.jsx)("h1",{style:{fontSize:"16px",fontWeight:500,margin:0},children:"VERIFY AND SET MAP PIN LOCATION"}),!b&&(0,a.jsxs)("div",{style:{marginLeft:"auto",fontSize:"12px",opacity:.8,display:"flex",alignItems:"center",gap:"5px"},children:[(0,a.jsx)("div",{style:{width:"8px",height:"8px",borderRadius:"50%",background:I?"#4CAF50":"#FFC107"}}),I?"Live Map":"Loading..."]})]}),(0,a.jsxs)("div",{style:{position:"absolute",top:"80px",left:"20px",right:"20px",zIndex:1e3},children:[(0,a.jsxs)("form",{onSubmit:e=>{e.preventDefault(),P.trim()&&(ne(P),q(!1))},style:{position:"relative"},children:[(0,a.jsx)("span",{style:{position:"absolute",left:"15px",top:"50%",transform:"translateY(-50%)",color:"#666",zIndex:1001,fontSize:"18px"},children:K?"\u23f3":"\ud83d\udd0d"}),(0,a.jsx)("input",{ref:e=>Q(e),type:"text",style:{width:"100%",maxWidth:"100%",padding:"12px 50px 12px 45px",border:$?"2px solid #2c5aa0":"none",borderRadius:$?"8px 8px 0 0":"8px",fontSize:"16px",color:"#333",background:"white",boxShadow:$?"0 2px 10px rgba(44,90,160,0.15)":"0 2px 10px rgba(0,0,0,0.1)",outline:"none",transition:"all 0.2s ease",boxSizing:"border-box"},placeholder:"Search for any location...",value:P,onChange:e=>(e=>{if(console.log("\ud83d\udd0d handleInputChange called with:",e),k(e),x.current&&clearTimeout(x.current),!e.trim())return q(!1),void H([]);console.log("\u23f1\ufe0f Setting debounce timer for autocomplete search..."),x.current=setTimeout(()=>{console.log("\ud83d\ude80 Debounce complete, calling performAutocompleteSearch..."),me(e)},300)})(e.target.value),onKeyDown:e=>{if($&&0!==F.length)switch(e.key){case"ArrowDown":e.preventDefault(),J(e=>e<F.length-1?e+1:0);break;case"ArrowUp":e.preventDefault(),J(e=>e>0?e-1:F.length-1);break;case"Enter":e.preventDefault(),V>=0&&F[V]?he(F[V]):P.trim()&&(ne(P),q(!1));break;case"Escape":q(!1),J(-1),X&&X.blur()}},onFocus:()=>{P.length>=2&&F.length>0&&q(!0)},onBlur:e=>{setTimeout(()=>{document.activeElement&&document.activeElement.closest('[role="listbox"]')||q(!1)},300)},autoComplete:"off"}),P&&(0,a.jsx)("button",{type:"button",onClick:()=>{k(""),q(!1),H([]),X&&X.focus()},style:{position:"absolute",right:"15px",top:"50%",transform:"translateY(-50%)",background:"none",border:"none",color:"#9ca3af",cursor:"pointer",fontSize:"18px",padding:"4px",borderRadius:"50%",transition:"color 0.2s ease"},onMouseEnter:e=>e.target.style.color="#6b7280",onMouseLeave:e=>e.target.style.color="#9ca3af",children:"\u2715"})]}),(0,a.jsx)(xe,{})]}),(0,a.jsxs)("div",{style:{width:"100%",height:"calc(100vh - 80px)",position:"relative"},children:[(0,a.jsx)("div",{ref:u,style:{width:"100%",height:"100%",minHeight:"400px",position:"absolute",top:0,left:0,display:I&&!b?"block":"none"}}),b&&(0,a.jsx)("div",{style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",zIndex:1e3},children:(0,a.jsxs)("div",{style:{textAlign:"center",background:"rgba(255, 255, 255, 0.95)",borderRadius:"20px",padding:"40px 30px",boxShadow:"0 20px 60px rgba(0,0,0,0.1)"},children:[(0,a.jsx)("div",{style:{fontSize:"48px",marginBottom:"20px"},children:"\ud83d\uddfa\ufe0f"}),(0,a.jsx)("div",{style:{width:"60px",height:"60px",border:"3px solid transparent",borderTop:"3px solid #2c5aa0",borderRadius:"50%",animation:"spin 1.5s linear infinite",margin:"20px auto"}}),(0,a.jsx)("h3",{style:{color:"#2c5aa0",fontSize:"24px",fontWeight:600,margin:"20px 0 10px 0"},children:"Loading Interactive Map"}),(0,a.jsx)("p",{style:{color:"#666",fontSize:"16px",margin:"0"},children:"Please wait..."})]})}),!b&&!I&&(0,a.jsxs)("div",{style:{width:"100%",height:"100%",background:"#f8f9fa",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"40px",textAlign:"center"},children:[(0,a.jsx)("div",{style:{fontSize:"64px",marginBottom:"20px"},children:"\ud83d\uddfa\ufe0f"}),(0,a.jsx)("h3",{style:{color:"#495057",fontSize:"24px",fontWeight:600,margin:"0 0 15px 0"},children:"Map Loading Failed"}),(0,a.jsx)("p",{style:{color:"#6c757d",fontSize:"16px",margin:"0 0 30px 0"},children:"Please check your internet connection and try again."}),(0,a.jsx)("button",{onClick:()=>window.location.reload(),style:{background:"#2c5aa0",color:"white",border:"none",borderRadius:"12px",padding:"15px 25px",fontSize:"16px",fontWeight:600,cursor:"pointer"},children:"\ud83d\udd04 Retry"})]})]}),(0,a.jsxs)("div",{style:{position:"absolute",bottom:0,left:0,right:0,background:"white",padding:"20px",boxShadow:"0 -2px 10px rgba(0,0,0,0.1)"},children:[(0,a.jsxs)("button",{style:{background:j?"#ccc":W?"linear-gradient(135deg, #059669 0%, #047857 100%)":"linear-gradient(135deg, #2c5aa0 0%, #1e3d6f 100%)",border:"none",borderRadius:"12px",padding:"15px 20px",width:"100%",textAlign:"left",cursor:j?"not-allowed":"pointer",marginBottom:"20px",display:"flex",alignItems:"center",fontSize:"16px",color:"white",fontWeight:"600"},onClick:async()=>{j||(console.log("\ud83d\udccd Starting automatic location request (Repill style)..."),B({show:!1,message:"",type:"success"}),console.log("\ud83d\udccb Letting getCurrentPosition handle permissions automatically..."),O(!1),ee())},disabled:j,children:[(0,a.jsx)("span",{style:{marginRight:"10px",fontSize:"18px"},children:j?"\u23f3":W?"\ud83c\udfaf":"\ud83d\udccd"}),(0,a.jsxs)("div",{style:{flex:1},children:[(0,a.jsx)("div",{style:{fontSize:"16px"},children:j?"Getting Your Location...":T&&N?"Open Settings to Enable Location":W?"Use High Accuracy Location":"Use Your Current Location"}),M>0&&!j&&(0,a.jsx)("div",{style:{fontSize:"12px",opacity:.8,marginTop:"2px"},children:T?N?"Tap to open app settings automatically":"Tap to request permission again":`Attempt ${M+1} \u2022 ${W?"High Accuracy":"Standard"}`})]})]}),(0,a.jsxs)("div",{style:{marginBottom:"15px"},children:[(0,a.jsx)("h3",{style:{fontSize:"16px",fontWeight:600,marginBottom:"5px",color:"#333",margin:"0 0 5px 0"},children:(null===f||void 0===f?void 0:f.name)||"Select Location"}),(0,a.jsx)("p",{style:{color:"#666",fontSize:"14px",lineHeight:1.4,margin:0},children:(null===f||void 0===f?void 0:f.address)||"Please select a location on the map or use current location"}),(null===f||void 0===f?void 0:f.accuracy)&&(0,a.jsxs)("p",{style:{color:"#9ca3af",fontSize:"12px",margin:"4px 0 0 0"},children:["Accuracy: \xb1",Math.round(f.accuracy),"m"]})]}),(0,a.jsx)("button",{style:{background:f?"linear-gradient(135deg, #22c55e 0%, #16a34a 100%)":"#e5e7eb",color:f?"white":"#9ca3af",border:"none",borderRadius:"12px",padding:"18px",width:"100%",fontSize:"17px",fontWeight:700,cursor:f?"pointer":"not-allowed",textTransform:"uppercase",letterSpacing:"0.5px"},onClick:()=>{console.log("\ud83d\udd18 Confirm button clicked, selectedLocation:",f),f?(console.log("\u2705 Location confirmed, calling onLocationSelect with:",f),o(f)):(console.log("\u274c No location selected"),Z("Please select a location first","info"))},disabled:!f,children:"CONFIRM LOCATION"})]})]})]})}}}]);
//# sourceMappingURL=835.60590c2b.chunk.js.map